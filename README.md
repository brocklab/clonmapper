# ClonMapper Protocol

## Setup

To make changes to the document you can clone this repo locally and use any plain text editor you prefer.

```bash
git clone git@github.com:brocklab/clonmapper-protocol.git
```

Alternatively you can make quick changes using the built-in github [VS-code editor](https://github.dev/brocklab/clonmapper-protocol).

If you would like to generate a new pdf file you will probably want to ensure at a minimum you have installed `make`.

This document takes advantage of pandoc to convert a markdown doc (`protocol.md`) to a well-formatted pdf.
To run these locally you will need to additionally install `pandoc` and `tex-live`.
*NOTE*: the full `tex-live` distribution is quite large.
Alternatively, if you have `docker` installed then you can append your `make` commands with `DOCKER=true`.

For a list of the common commands run `make help`.

## Generating the PDF

To make a new pdf you should only need to run the below command.

```bash
make pdf
```

This will generate a new pdf document at `./clonmapper-protocol-<rev>.pdf`.
If you make changes and commit them a new `rev` id will be appended to the file based on the `HEAD` of the repo.

## Generating the Website

To get started generate a python virtual environment to install `mkdocs` and its plugins.

```sh
make bootstrap
```

There are several `make` recipes for updating the website.
To start a development server with the website use the below:

```sh
make docs.server
```

Note that the latest pdf as well as any actual protocol markdown's (`docs/full-protocol.md`,`docs/protocol/*.md`)
are auto-generated within the website docs and should not be edited by hand.
Some of the syntax used with `pandoc` is first removed (see `./scripts/pre-mkdocs-sanitize`),
as well as all the individual markdown's combined for the `full-protocol.md`

## Editing Instructions

### Tables

Tables are automatically generated from the `csvs` found in `./tables`. Do not edit the tables generated by latex directly.
To manually regenerate the `latex` for a table you can use the included script.
If you update the csv. `Make` will regenerate the appropriate latex file for you.

```bash
./scripts/csv2latex tables/oligos.csv tex/oligos.tex "Oligonucleotides."
```

### Citations

Citations should follow the format `[@lastnameYYYY]`. Any new citations need to be added to the bibliography in `./bib`

## Legacy Version

The original version of this manuscript can be found in the [legacy](./legacy) directory.

To start with it was converted to markdown using:

```bash
pandoc -s legacy/Gardner.MethodsMolBiol.SubmittedAug2019.docx --wrap=none --reference-links -t markdown -o protocol.md
```

For subsequent changes from the legacy version please see the commit history.
